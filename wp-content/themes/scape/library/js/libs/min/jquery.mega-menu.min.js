!function(e,t,s){"use strict";function a(t,s){this.element=t,this.settings=e.extend({},o,s),this._defaults=o,this._name=l,this.init()}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter((function(){return"hidden"===e.css(this,"visibility")})).length}function n(t,s){var a,n,l,o=t.nodeName.toLowerCase();return"area"===o?(n=(a=t.parentNode).name,!(!t.href||!n||"map"!==a.nodeName.toLowerCase())&&(!!(l=e("img[usemap=#"+n+"]")[0])&&i(l))):(/input|select|textarea|button|object/.test(o)?!t.disabled:"a"===o&&t.href||s)&&i(t)}var l="accessibleMegaMenu",o={uuidPrefix:"accessible-megamenu",menuClass:"accessible-megamenu",topNavItemClass:"accessible-megamenu-top-nav-item",panelClass:"accessible-megamenu-panel",panelGroupClass:"accessible-megamenu-panel-group",hoverClass:"hover",focusClass:"focus",openClass:"open"},r={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38,keyMap:{48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",190:"."}},u,c,f,d,h,p,b,m,g,C,x,v,y,T,D,k,E;a.prototype=(u=0,c=1e3,f="",d="function"==typeof t.hasOwnProperty&&!!t.hasOwnProperty("ontouchstart"),h=function(t){return e(t).closest(":data(plugin_"+l+")").data("plugin_"+l)},p=function(t){t=e(t);var s=this.settings;t.attr("id")||t.attr("id",s.uuidPrefix+"-"+(new Date).getTime()+"-"+ ++u)},b=function(t,a){var i=e(t.target),n=this,l=this.settings,o=this.menu,u=i.closest("."+l.topNavItemClass),c=i.hasClass(l.panelClass)?i:i.closest("."+l.panelClass),f;if(E.call(this,a),e("html").off("mouseup.outside-accessible-megamenu, touchend.outside-accessible-megamenu, mspointerup.outside-accessible-megamenu, pointerup.outside-accessible-megamenu",g),o.find("[aria-expanded]."+this.settings.panelClass).off("DOMAttrModified.accessible-megamenu"),a)if((u=o.find("."+l.topNavItemClass+" ."+l.openClass+":first").closest("."+l.topNavItemClass)).is(t.relatedTarget)||u.has(t.relatedTarget).length>0)0===u.length&&o.find("[aria-expanded=true]").attr("aria-expanded","false").removeClass(l.openClass).filter("."+l.panelClass).attr("aria-hidden","true");else{if(("mouseout"===t.type||"focusout"===t.type)&&u.has(s.activeElement).length>0)return;u.find("[aria-expanded]").attr("aria-expanded","false").removeClass(l.openClass).filter("."+l.panelClass).attr("aria-hidden","true"),("keydown"===t.type&&t.keyCode===r.ESCAPE||"DOMAttrModified"===t.type)&&(f=u.find(":tabbable:first"),setTimeout((function(){o.find("[aria-expanded]."+n.settings.panelClass).off("DOMAttrModified.accessible-megamenu"),f.focus(),n.justFocused=!1}),99))}else clearTimeout(n.focusTimeoutID),u.siblings().find("[aria-expanded]").attr("aria-expanded","false").removeClass(l.openClass).filter("."+l.panelClass).attr("aria-hidden","true"),u.find("[aria-expanded]").attr("aria-expanded","true").addClass(l.openClass).filter("."+l.panelClass).attr("aria-hidden","false"),jQuery(this.element).trigger("megamenu:open",u.find("[aria-expanded]")),"mouseover"===t.type&&i.is(":tabbable")&&1===u.length&&0===c.length&&o.has(s.activeElement).length>0&&(i.focus(),n.justFocused=!1),E.call(n)},m=function(t){var s=e(t.target),a=s.closest("."+this.settings.topNavItemClass),i=s.closest("."+this.settings.panelClass);1===a.length&&0===i.length&&a.find("."+this.settings.panelClass).length&&(s.hasClass(this.settings.openClass)?this.justFocused?this.justFocused=!1:d&&(t.preventDefault(),t.stopPropagation(),b.call(this,t,s.hasClass(this.settings.openClass))):(t.preventDefault(),t.stopPropagation(),b.call(this,t)))},g=function(t){0===this.menu.has(e(t.target)).length&&(t.preventDefault(),t.stopPropagation(),b.call(this,t,!0))},C=function(t){"aria-expanded"===t.originalEvent.attrName&&"false"===t.originalEvent.newValue&&e(t.target).hasClass(this.settings.openClass)&&(t.preventDefault(),t.stopPropagation(),b.call(this,t,!0))},x=function(t){clearTimeout(this.focusTimeoutID),e(t.target).addClass(this.settings.focusClass).on("click.accessible-megamenu",e.proxy(m,this)),this.justFocused=!0,this.panels.filter("."+this.settings.openClass).length&&b.call(this,t)},v=function(s){this.justFocused=!1;var a=this,i=e(s.target),n=i.closest("."+this.settings.topNavItemClass),l=!1;i.removeClass(this.settings.focusClass).off("click.accessible-megamenu",m),t.cvox?a.focusTimeoutID=setTimeout((function(){t.cvox.Api.getCurrentNode((function(e){n.has(e).length?clearTimeout(a.focusTimeoutID):a.focusTimeoutID=setTimeout((function(e,t,s){b.call(e,t,s)}),275,a,s,!0)}))}),25):a.focusTimeoutID=setTimeout((function(){b.call(a,s,!0)}),300)},y=function(s){var a=e(e(this).is(".hover:tabbable")?this:s.target),i=a.is(s.target)?this:h(a),n=i.settings,l=i.menu,o=i.topnavitems,u=a.closest("."+n.topNavItemClass),c=l.find(":tabbable"),d=a.hasClass(n.panelClass)?a:a.closest("."+n.panelClass),p=d.find("."+n.panelGroupClass),g=a.closest("."+n.panelGroupClass),C,x=s.keyCode||s.which,v,y,T,D,k=!1,E=r.keyMap[s.keyCode]||"",I,N=1===u.length&&0===d.length;switch(a.is(".hover:tabbable")&&e("html").off("keydown.accessible-megamenu"),x){case r.ESCAPE:b.call(i,s,!0);break;case r.DOWN:s.preventDefault(),N?(b.call(i,s),k=1===u.find("."+n.panelClass+" :tabbable:first").focus().length):k=1===c.filter(":gt("+c.index(a)+"):first").focus().length,!k&&t.opera&&"[object Opera]"===opera.toString()&&(s.ctrlKey||s.metaKey)&&(y=(c=e(":tabbable")).index(a),k=1===e(":tabbable:gt("+e(":tabbable").index(a)+"):first").focus().length);break;case r.UP:s.preventDefault(),N&&a.hasClass(n.openClass)?(b.call(i,s,!0),(C=o.filter(":lt("+o.index(u)+"):last")).children("."+n.panelClass).length&&(k=1===C.children().attr("aria-expanded","true").addClass(n.openClass).filter("."+n.panelClass).attr("aria-hidden","false").find(":tabbable:last").focus(),jQuery(this.element).trigger("megamenu: open",C.children()))):N||(k=1===c.filter(":lt("+c.index(a)+"):last").focus().length),!k&&t.opera&&"[object Opera]"===opera.toString()&&(s.ctrlKey||s.metaKey)&&(y=(c=e(":tabbable")).index(a),k=1===e(":tabbable:lt("+e(":tabbable").index(a)+"):first").focus().length);break;case r.RIGHT:s.preventDefault(),N?k=1===o.filter(":gt("+o.index(u)+"):first").find(":tabbable:first").focus().length:(p.length&&g.length&&(k=1===p.filter(":gt("+p.index(g)+"):first").find(":tabbable:first").focus().length),k||(k=1===u.find(":tabbable:first").focus().length));break;case r.LEFT:s.preventDefault(),N?k=1===o.filter(":lt("+o.index(u)+"):last").find(":tabbable:first").focus().length:(p.length&&g.length&&(k=1===p.filter(":lt("+p.index(g)+"):last").find(":tabbable:first").focus().length),k||(k=1===u.find(":tabbable:first").focus().length));break;case r.TAB:y=c.index(a),s.shiftKey&&N&&a.hasClass(n.openClass)?(b(s,!0),(C=o.filter(":lt("+o.index(u)+"):last")).children("."+n.panelClass).length&&(k=C.children().attr("aria-expanded","true").addClass(n.openClass).filter("."+n.panelClass).attr("aria-hidden","false").find(":tabbable:last").focus(),jQuery(this.element).trigger("megamenu: open",C.children()))):s.shiftKey&&y>0?k=1===c.filter(":lt("+y+"):last").focus().length:!s.shiftKey&&y<c.length-1?k=1===c.filter(":gt("+y+"):first").focus().length:t.opera&&"[object Opera]"===opera.toString()&&(y=(c=e(":tabbable")).index(a),k=s.shiftKey?1===e(":tabbable:lt("+e(":tabbable").index(a)+"):last").focus().length:1===e(":tabbable:gt("+e(":tabbable").index(a)+"):first").focus().length),k&&s.preventDefault();break;case r.SPACE:N&&(s.preventDefault(),m.call(i,s));break;default:if(clearTimeout(this.keydownTimeoutID),0===(f+=E!==f?E:"").length)return;for(this.keydownTimeoutID=setTimeout((function(){f=""}),1e3),c=N&&!a.hasClass(n.openClass)?c.filter("."+n.topNavItemClass+" > :tabbable"):u.find(":tabbable"),s.shiftKey&&(c=e(c.get().reverse())),y=0;y<c.length;y++)if((T=c.eq(y)).is(a)){v=1===f.length?y+1:y;break}for(I=new RegExp("^"+f.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),"i"),y=v;y<c.length;y++)if(T=c.eq(y),D=e.trim(T.text()),I.test(D)){k=!0,T.focus();break}if(!k)for(y=0;y<v;y++)if(T=c.eq(y),D=e.trim(T.text()),I.test(D)){T.focus();break}break}i.justFocused=!1},T=function(e){this.mouseTimeoutID=setTimeout((function(){clearTimeout(this.focusTimeoutID)}),1)},D=function(t){clearTimeout(this.mouseTimeoutID),e(t.target).addClass(this.settings.hoverClass),b.call(this,t),e(t.target).is(":tabbable")&&e("html").on("keydown.accessible-megamenu",e.proxy(y,t.target))},k=function(t){var s=this;e(t.target).removeClass(s.settings.hoverClass),s.mouseTimeoutID=setTimeout((function(){b.call(s,t,!0)}),0),e(t.target).is(":tabbable")&&e("html").off("keydown.accessible-megamenu")},E=function(t){var s=this.menu;t?(e("html").off("mouseup.outside-accessible-megamenu, touchend.outside-accessible-megamenu, mspointerup.outside-accessible-megamenu,  pointerup.outside-accessible-megamenu",g),s.find("[aria-expanded]."+this.settings.panelClass).off("DOMAttrModified.accessible-megamenu",C)):(e("html").on("mouseup.outside-accessible-megamenu, touchend.outside-accessible-megamenu, mspointerup.outside-accessible-megamenu,  pointerup.outside-accessible-megamenu",e.proxy(g,this)),s.find("[aria-expanded=true]."+this.settings.panelClass).on("DOMAttrModified.accessible-megamenu",e.proxy(C,this)))},{constructor:a,init:function(){var t=this,s=this.settings,a=this.justFocused=!1,i=this.nav=e(this.element),n=this.menu=i.children().first(),l=this.topnavitems=n.children();i.attr("role","navigation"),n.addClass(s.menuClass),l.each((function(a,i){var n,l;(i=e(i)).addClass(s.topNavItemClass),n=i.find(":tabbable:first"),l=i.children(".sub-menu:not(:tabbable):last"),p.call(t,n),l.length&&(p.call(t,l),n.attr({"aria-haspopup":!0,"aria-owns":l.attr("id"),"aria-controls":l.attr("id"),"aria-expanded":!1}),l.attr({role:"group","aria-expanded":!1,"aria-hidden":!0}).addClass(s.panelClass).not("[aria-labelledby]").attr("aria-labelledby",n.attr("id")))})),this.panels=n.find("."+s.panelClass),n.on("focusin.accessible-megamenu",":tabbable, :focusable, ."+s.panelClass,e.proxy(x,this)).on("focusout.accessible-megamenu",":tabbable, :focusable, ."+s.panelClass,e.proxy(v,this)).on("keydown.accessible-megamenu",e.proxy(y,this)).on("mouseover.accessible-megamenu",e.proxy(D,this)).on("mouseout.accessible-megamenu",e.proxy(k,this)).on("mousedown.accessible-megamenu",e.proxy(T,this)),d&&n.on("touchstart.accessible-megamenu",e.proxy(m,this)),n.find("hr").attr("role","separator")},getDefaults:function(){return this._defaults},getOption:function(e){return this.settings[e]},getAllOptions:function(){return this.settings},setOption:function(e,t,s){this.settings[e]=t,s&&this.init()}}),e.fn[l]=function(t){return this.each((function(){e.data(this,"plugin_"+l)||e.data(this,"plugin_"+l,new a(this,t))}))},e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo((function(t){return function(s){return!!e.data(s,t)}})):function(t,s,a){return!!e.data(t,a[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var s=e.attr(t,"tabindex"),a=isNaN(s);return(a||s>=0)&&n(t,!a)}})}(jQuery,window,document);